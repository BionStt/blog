var blogStoryManager={tags:[],publishText:"Published",initialize:function(e){this.tags=e,this.initializeShortCuts(),tinyMCE.baseURL="https://cdn.jsdelivr.net/npm/tinymce@4.7.13/",tinymce.init({selector:".editor",height:500,menubar:!0,branding:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste codesample"],toolbar:"undo redo | insert | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | codesample",codesample_languages:[{text:"HTML/XML",value:"markup"},{text:"JavaScript",value:"javascript"},{text:"CSS",value:"css"},{text:"C",value:"c"},{text:"C#",value:"csharp"},{text:"ASP.NET MVC",value:"aspnet"},{text:"Bash",value:"bash"},{text:"Powershell",value:"powershell"},{text:"DockerFile",value:"docker"},{text:"Yaml",value:"yaml"}],setup:function(e){e.shortcuts.add("ctrl+s","save story",function(){$("#edit-story").submit()}),e.on("FullscreenStateChanged",function(e){var t=$("#edit-story"),i="#fullscreen",a=t.attr("action");e.state?(window.location.hash=i,t.attr("action",a+window.location.hash)):(window.location.hash="",t.attr("action",a.replace(i,"")))}),e.on("init",function(){"#fullscreen"===window.location.hash&&tinyMCE.execCommand("mceFullScreen")})}}),this.initializeTagsSelector(),this.initializeActions()},initializeTagsSelector:function(){$(".tag-editor").length&&(this.tagsSelectize=$(".tag-editor").selectize({plugins:["remove_button"],delimiter:",",maxItems:3,valueField:"id",labelField:"name",searchField:"name",options:this.tags,create:function(e,i){var t=JSON.stringify({name:e});$.ajax({type:"POST",url:"/author/tags",data:t,contentType:"application/json",success:function(e){var t={id:e.id,name:e.name};i(t),blogStoryManager.tags.push(t)},error:function(e){alert(e)}})}}))},initializeActions:function(){$("#publish-btn").click(function(){var e=$(this),t=$("#Id").val(),i=e.attr("set");$.ajax({type:"PATCH",url:"/author/stories/"+t+"?isPublished="+i,contentType:"application/json",success:function(e){e&&(e.redirect?location.replace(e.redirect):location.reload())},error:function(e){alert(e)}})}),$("#update-access-token-btn").click(this.updateAccessToken),$("#remove-access-token-btn").click(this.removeAccessToken)},initializeShortCuts:function(){$(window).bind("keydown",function(e){if(e.ctrlKey||e.metaKey)switch(String.fromCharCode(e.which).toLowerCase()){case"s":e.preventDefault(),$("#edit-story").submit()}})},updateAccessToken:function(){var e=$("#Id").val();$.ajax({type:"POST",url:"/author/stories/"+e+"/accesstoken",success:function(){document.location.reload()}})},removeAccessToken:function(){var e=$("#Id").val();$.ajax({type:"DELETE",url:"/author/stories/"+e+"/accesstoken",success:function(){document.location.reload()}})}};